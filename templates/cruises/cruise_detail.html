{% extends 'base.html' %}
{% load static %}

{% block title %}{{ cruise.name }} - Travel in Style{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/cruise_detail.css' %}">
{% endblock %}

{% block content %}
<div class="cruise-header" style="background-image: url('{{ cruise.get_image_url }}');">
    <div class="container">
        <h1 class="display-4">{{ cruise.name }}</h1>
        <p class="lead">{{ cruise.cruise_type.name }} Cruise by {{ cruise.company.name }}</p>
    </div>
</div>

<div class="about-us">
    <div class="container">
        <div class="row natur-row">
            <div class="col-md-8">
                <h2 class="mb-4">About This Cruise</h2>
                <div class="cruise-description">
                    {{ cruise.description|linebreaks|safe }}
                </div>
                
                <h3 class="mt-5 mb-4">Key Features</h3>
                <div class="row">
                    <div class="col-md-4 text-center mb-4">
                        <i class="fas fa-ship feature-icon mb-2"></i>
                        <h5>{{ cruise.cruise_type.name }}</h5>
                    </div>
                    <div class="col-md-4 text-center mb-4">
                        <i class="fas fa-users feature-icon mb-2"></i>
                        <h5>{{ cruise.sessions.first.capacity }} Passengers</h5>
                    </div>
                    <div class="col-md-4 text-center mb-4">
                        <i class="fas fa-map-marked-alt feature-icon mb-2"></i>
                        <h5>Multiple Destinations</h5>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="image-part">
                    <div class="card">
                        <div class="card-body">
                            <h3 class="card-title">Quick Info</h3>
                            <ul class="list-unstyled">
                                <li><i class="far fa-calendar-alt mr-2"></i> Duration: 
                                    {% with session=cruise.sessions.first %}
                                        {{ session.start_date|date:"M d" }} - {{ session.end_date|date:"M d, Y" }}
                                    {% endwith %}
                                </li>
                                <li><i class="fas fa-phone mr-2"></i> Contact: +1 (800) 123-4567</li>
                                <li><i class="fas fa-envelope mr-2"></i> Email: info@travelinstyle.com</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="category-section">
    <div class="container">
        <h2 class="text-center mb-4">Select Your Cabin Category</h2>
        <div class="row">
            {% for category_price in cruise.cruisecategoryprice_set.all %}
            <div class="col-md-4 mb-4">
                <div class="category-card" data-category-id="{{ category_price.category.id }}">
                    <div class="category-card-header">
                        {{ category_price.category.name }}
                    </div>
                    <div class="category-card-body">
                        <div class="category-description">
                            <p>{{ category_price.category.description }}</p>
                        </div>
                        <h5>Equipment</h5>
                        <ul class="equipment-list">
                            {% for equipment in category_price.category.equipment.all %}
                            <li>{{ equipment.name }}</li>
                            {% endfor %}
                        </ul>
                        <div class="price">
                            â‚¬{{ category_price.price|floatformat:2 }}
                        </div>
                    </div>
                    <div class="category-card-footer">
                        <button class="select-btn">Select Category</button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>



<div id="sessionSelect" class="why-choos-us">
    <div class="container">
        <div class="session-title row">
            <h2>Select Your Cruise Session</h2>
        </div>
        <div class="row why-ro">
            <div class="col-lg-12 col-md-12">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Departure Date</th>
                                <th>Return Date</th>
                                <th>Available Capacity</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for session in cruise.sessions.all %}
                            <tr>
                                <td>{{ session.start_date|date:"M d, Y" }}</td>
                                <td>{{ session.end_date|date:"M d, Y" }}</td>
                                <td>{{ session.capacity }}</td>
                                <td><button class="btn btn-sm btn-primary book-btn" data-session-id="{{ session.id }}">Select</button></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    var bookCruiseUrl = "{% url 'book_cruise' cruise.id %}";
</script>
<script src="{% static 'js/cruise_detail.js' %}"></script>
{% endblock %}